---
layout: post
comments: true
title: "웹 접근성이 충분히 보장된 abbr 요소, 만들어보자"
excerpt: ""
header:
  overlay_image: /assets/images/thumb/html_thumb01.jpg
  overlay_filter: 0.5
date: 2020-03-04 22:28
categories:
    - 퍼블노트
tags:
    - html
    - web-accessibility
primary_post: true
---
abbreviations의 약자인 abbr 요소는 말 그대로 약어를 나타내는 데 사용하는 태그이다. 다음과 같이 마크업하여 사용할 수 있음.

{:.has-label}
```html
<abbr title="HyperText Markup Language">HTML</abbr>
```

마우스 커서를 올렸을 때 title 속성을 통해 약어에 대한 설명을 제공해준다. 그러나 키보드 사용만으로 웹 페이지를 탐색하는 사용자의 경우 또는 마우스 이벤트가 불가능한 모바일 환경이라면?  Javascript 등을 이용하여 동일한 사용자 경험을 제공해주는 게 상식에 맞다고 볼 수 있다.

## 방법 1

{:.has-label}
```scss
abbr[title] {
  position: relative;
  cursor: help;
  
  &:after {
    content: attr(title);
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    padding: 0.7em;
    background: #fff;
    box-shadow: rgba(0,0,0,0.2) 1px 2px 4px 0;
    cursor: text;
  }

  &:focus:after,
  &:active:after {
    display: block;
  }
}
```

<p class="codepen" data-height="265" data-theme-id="default" data-default-tab="css,result" data-user="selucky" data-slug-hash="vYOJoqN" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="vYOJoqN">
  <span>See the Pen <a href="https://codepen.io/selucky/pen/vYOJoqN">
  vYOJoqN</a> by sel (<a href="https://codepen.io/selucky">@selucky</a>)
  on <a href="https://codepen.io">CodePen</a>.</span>
</p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>

abbr 요소는 title 속성없이 풀어쓸 수 있으므로[^1], title 속성을 가진 abbr 요소를 선택해준다.

content 속성에 abbr title 속성값을 대입해주는 방법으로, JS를 활용하지 않고 CSS로만 핸들링했다는 게 특징.

하지만 IE에서 NVDA로 테스트 결과 content 속성값을 읽지 못하는 문제가 있다. 웹 접근성을 확보하고자 한다면 다음 방법을 고려해보자.

## 방법 2

{:.has-label}
```html
<abbr title="HyperText Markup Language" aria-describedby="tooltip of this title">HTML</abbr>
```
abbr을 tooltip과 연결시키기 위해 <code>aria-describedby</code> 속성을 명시해준다.

{:.has-label}
```scss
abbr[title] {
  position: relative;
  border-bottom: 1px dotted #333;
  text-decoration: none;
  cursor: help;
}

.abbr__tooltip {
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  width: auto;
  height: auto;
  padding: 0.7em;
  background: #fff;
  box-shadow: rgba(0,0,0,0.2) 1px 2px 4px 0;
  cursor: text;
  
  &--active {
    display: block;
  }
}
```
CSS는 적당히 만들어주고

{:.has-label}
```javascript
$("abbr[title]").each(function() {
  $(this)
    .attr("tabindex", "0")
    .append("<span class='abbr__tooltip' tabindex='0' role='tooltip' id='"+$(this).attr("aria-describedby")+"' hidden>"+$(this).attr('title')+"</span>");
});

$("abbr[title]").on("click", function(evt) {
  if (evt.target !== evt.currentTarget) return;
  
  var tooltip = $(evt.currentTarget).children(".abbr__tooltip");
  
  if (!tooltip.hasClass("abbr__tooltip--active")) {
    tooltip.prop("hidden", false);
    tooltip.addClass("abbr__tooltip--active");
  } else {
    tooltip.prop("hidden", true);
    tooltip.removeClass("abbr__tooltip--active");
  }
});
```
Javascript로 다음과 같은 순서로 구현해준다(Vanilla JS로 작성하면 좀 길어질 것 같아 쉬운(?) 설명을 위해 jQuery로 작성했음.).

1. 모든 abbr 요소에 초점 이동 가능하게 해준다.
2. 각 abbr 요소에 대한 tooltip을 생성해주고, tooltip 역할을 부여함과 동시에 abbr의 <code>aria-describedby</code> 속성값을 id값에 대입, abbr과 tooltip을 연결시켜준다.
3. abbr 요소의 click 이벤트에 대응하는 handler를 만들어준다.

실제로 title/aria-describedby 속성값에 공백/한글이 포함되어 있을 경우 작동하지 않으므로, 공백을 문자열로 치환하고 한글도 이스케이프 문자로 치환하는 로직을 구현해야 한다. tooltip JS 구현에 중점을 맞추려고 해당 과정은 생략하였음. 그래놓고 블로그 JS에는 잘만 적용해놓은..

<p class="codepen" data-height="265" data-theme-id="default" data-default-tab="js,result" data-user="selucky" data-slug-hash="bGdobEo" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="bGdobEo">
  <span>See the Pen <a href="https://codepen.io/selucky/pen/bGdobEo">
  bGdobEo</a> by sel (<a href="https://codepen.io/selucky">@selucky</a>)
  on <a href="https://codepen.io">CodePen</a>.</span>
</p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>

WAI-ARIA를 사용, 보조기기에서 태그의 용도를 더욱 명확하게 파악할 수 있게끔 해주었고, 결과적으로 웹 접근성 퍼포먼스가 향상되었다.

[^1]: [1] 예) ```<p>HyperText Markup Language(<abbr>HTML</abbr>)</p>```{:.language-html}