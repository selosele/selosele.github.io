---
published: false
layout: post
comments: true
title: "최근의 삽질과 깨달음"
subtitle:
header:
  overlay_image: /assets/images/thumb/js_thumb01.jpg
  overlay_filter: 0.4
  image_position-y: 57%
  image_link: https://pixabay.com/ko/photos/%EC%9E%90%EB%B0%94-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8-%EC%BD%94%EB%93%9C-4523100/
  image_author: Alltechbuzz
date: 2020-11-13 22:07
categories:
    - 퍼블노트
tags:
    - javascript
---

요즘은 포스팅을 각 주제별로 하지 않고, 일정 주기마다 주제들을 모아서 하나의 포스트를 작성하는 방식에 익숙해지려고 함.. 
포스트가 점점 늘어날수록 찾기 힘든 게 결정적인 이유이다. 찾기 편하려고 태그/카테고리별 분류, 검색 기능을 넣어놓긴 했으나 후자의 방식이 개인적으로 재밌어진 것도 있다.

아무튼, 최근 실무에서의 삽질과 그로 인해 얻은 귀중한(?) 깨달음을 간추려보았음.

## $(window).on("load")를 $(document).ready 안에 작성해선 안된다.

```javascript
$(function() {
    console.log("1");

    $(window).on("load", function() {
        console.log("2");
    });
});

// 결과 : 1
```

결론부터 말하면 저렇게 작성할 경우 작동하지 않는다.  
저렇게 썼다가 작동하지 않아 찾아보니 jQuery 버전 3 이상부터 <mark>$(document).ready</mark>는 비동기 방식으로 동작하며,  
<mark>$(window).on("load")</mark>를 <mark>$(document).ready</mark> 안에 포함시킬 수 없다고 함.

```javascript
$(function() {
    console.log("1");
});

$(window).on("load", function() {
    console.log("2");
});

// $(document).ready가 비동기 방식으로 작동하므로 코드의 실행 순서는 2 → 1이다.
```

때문에 <mark>$(window).on("load")</mark>를 외부로 빼서 작성하면 정상적으로 작동한다.  
load말고 resize 등 $(window)에 이벤트를 바인딩할 땐 무조건 <mark>$(document).ready</mark> 밖으로 빼서 작성하는 게 좋을 듯.

**참고 링크**

* [jquery window on load and resize not running](https://stackoverflow.com/questions/43700085/jquery-window-on-load-and-resize-not-running){:target="_blank" rel="external nofollow"}
* [window load inside a document ready?](https://stackoverflow.com/questions/5006922/window-load-inside-a-document-ready){:target="_blank" rel="external nofollow"}

---

## jQuery 이벤트가 실행되지 않게 하기

vanilla JS로는 removeEventListener 함수로 이벤트 리스너를 삭제하면 되는데,  
jQuery로 어떻게 하더라.. 떠오르지 않았다. 구글링도 이상하게 했는지 답은 찾을 수 없었고, 결국 해결하긴 했음.

일단 문제의 코드는 다음과 같다.

```javascript
$(".element").on("mouseover focusin", function() {
    ...
});
```

개발자도구 모바일 모드에서 테스트해보니 mouseover와 focusin 이벤트가 겹쳐서 오류가 났었다.  
그래서 애꿎은 마크업, CSS에 문제가 있나 찾아보고,  
결국 mouseover를 모바일에서 실행 안되게 하려고 삽질 끝에 아래와 같이 작성하였다.

```javascript
$(".element").on("mouseover focusin", function(event) {
    if ($(window).outerWidth() <= 1200 && event.type === "mouseover") {
      return;
    }

    ...
});
```

모바일(1200px 이하)일 때 &amp; event.type이 mouseover일 때는 함수가 실행되지 않게 만들었다.  
더 좋은 방법이 있다는 것을 알지 못한 채...

```javascript
$(".element").on("mouseover focusin", function() {
    ...
});

if ($(window).outerWidth() <= 1200) {
    $(".element").off("mouseover");
}
```

복잡한 event.type보단 그냥 jQuery에서 제공하는 off 함수로 이벤트를 삭제해주면 된다.